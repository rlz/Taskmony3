type Query {
  tasks(
    id: [ID!]
    directionId: [ID]
    withNotificationsAfter: String
    offset: Int
    limit: Int
  ): [Task!]
 
  ideas(
    id: [ID!]
    directionId: [ID]
    withNotificationsAfter: String
    offset: Int
    limit: Int
  ): [Idea!]

  users(
    id: [ID!]
    email: [String!]
    login: [String!]
    offset: Int
    limit: Int
  ): [User!]

  directions(id: [ID!]): [Direction!]
}

type Mutation {
  taskAdd(input: TaskAddInput!): Task
  ideaAdd(input: IdeaAddInput!): Idea
  directionAdd(input: DirectionAddInput!): Direction
  taskAddComment(input: TaskAddCommentInput!): Comment
  ideaAddComment(input: IdeaAddCommentInput!): Comment 
  tasksGenerate(input: TasksGenerateInput!): [ID!]

  taskSetDescription(taskId: ID!, description: String!): ID
  taskSetDetails(taskId: ID!, details: String): ID
  taskSetDirection(taskId: ID!, directionId: ID): ID
  taskSetDeletionDate(taskId: ID!, deletionDate: String): ID
  taskSetAssignee(taskId: ID!, assigneeId: ID): ID
  taskSetStartDate(taskId: ID!, startDate: String): ID
  taskSetCompletionDate(taskId: ID!, completionDate: String): ID
  taskRecurringDeleteAll(groupID: ID!): [ID!]

  ideaSetDescription(ideaId: ID!, description: String!): ID
  ideaSetDetails(entityId: ID!, details: String): ID
  ideaSetDirection(ideaId: ID!, directionId: ID): ID
  ideaSetDeletionDate(ideaId: ID!, deletionDate: String): ID
  ideaSetGeneration(ideaId: ID!, generation: Generation!): ID
  ideaSetReviewDate(ideaId: ID!, reviewDate: String): ID

  commentSetText(commentId: ID!, text: String!): ID

  directionSetName(directionId: ID!, name: String!): ID
  directionSetDetails(directionId: ID!, details: String): ID
  directionAddMember(directionId: ID!, userId: ID!): ID
  directionRemoveMember(directionId: ID!, userId: ID!): ID

  userSetNotificationReadTime(notificationReadTime: String!): ID
  userSetLogin(login: String!): ID
  userSetDisplayName(displayName: String!): ID
  userSetEmail(email: String!): ID
  userSetPassword(password: String!): ID

  taskSubscribe(taskId: ID!): ID
  ideaSubscribe(ideaId: ID!): ID

  taskUnsubscribe(taskId: ID!): ID
  ideaUnsubscribe(ideaId: ID!): ID
}

input TasksGenerateInput {
  description: String!
  details: String
  assigneeId: ID
  directionId: ID
  startDate: String!
  creationDate: String!
  repeatMode: RepeatMode!
  repeatEvery: Int
  numberOfRepetitions: Int!
}

input IdeaAddCommentInput {
  ideaId: ID!
  text: String!
  time: String!
}

input TaskAddCommentInput {
  taskId: ID!
  text: String!
  time: String!
}

input DirectionAddInput {
  name: String!
  creationDate: String!
  details: String
}

input IdeaAddInput {
  description: String!
  details: String
  assigneeId: ID
  directionId: ID
  generation: Generation!
  creationDate: String!
}

input TaskAddInput {
  description: String!
  details: String
  assigneeId: ID
  directionId: ID
  startDate: String!
  creationDate: String!
}

enum RepeatMode {
  DAY
  WEEK
  MONTH
  YEAR
  CUSTOM
}

type Task {
  id: ID!
  description: String
  details: String
  createdBy: User
  assignee: User
  startDate: String
  completionDate: String
  direction: Direction
  creationDate: String
  deletionDate: String
  comments: [Comment!]
  subscribers: [User!]
  groupID: ID
  notifications: [Notification!]
}

enum Generation {
  HOT
  LATER
  TOO_GOOD_TO_DELETE
}

type Idea {
  id: ID!
  description: String
  details: String
  generation: Generation
  createdBy: User
  direction: Direction
  creationDate: String
  deletionDate: String
  reviewDate: String
  comments: [Comment!]
  subscribers: [User!]
  notifications: [Notification!]
}

type User {
  id: ID!
  login: String
  password: String
  displayName: String
  email: String
  """
  Last notification read time
  """
  notificationReadTime: String
  tasks: [Task!]
  ideas: [Idea!]
}

type Comment {
  id: ID!
  author: User
  time: String
  text: String
}

type Direction {
  id: ID!
  name: String
  details: String
  owner: User
  members: [User!]
  tasks: [Task!]
  ideas: [Idea!]
}

enum ActionType {
  """
  Task added to the direction
  """
  TASK_ADDED
  """
  Task deleted (from the direction or subscribed task)
  """
  TASK_DELETED
  """
  Task assigned to the user
  """
  TASK_ASSIGNED
  """
  Idea added to the direction
  """
  IDEA_ADDED
  """
  Idea deleted (from the direction or subscribed idea)
  """
  IDEA_DELETED
  """
  Member added to the direction
  """
  MEMBER_ADDED
  """
  Comment added to the task or idea
  """
  COMMENT_ADDED
  """
  Task, idea or direction updated
  """
  ITEM_UPDATED
}

union ActionItem = User | Task | Idea | Comment

type Notification {
  id: ID!
  time: String
  actor: User           
  actionType: ActionType
  actionItem: ActionItem
}
